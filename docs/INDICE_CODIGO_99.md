# üìë √çndice - Documentaci√≥n C√≥digo 99

## Gu√≠a Completa de Recursos sobre el C√≥digo 99 "SIN RESPUESTA DGII"

---

## üìö Documentos Disponibles

### 1. **RESUMEN_CODIGO_99.md** ‚≠ê COMIENZA AQU√ç

**Prop√≥sito:** Resumen ejecutivo de la implementaci√≥n

**Contenido:**

- Problema identificado
- Soluci√≥n implementada
- Estado normalizado
- Archivos modificados
- Testing y verificaci√≥n
- Pr√≥ximos pasos

**Para qui√©n:** Desarrolladores, administradores del sistema

**Enlace:** [RESUMEN_CODIGO_99.md](./RESUMEN_CODIGO_99.md)

---

### 2. **CODIGO_99_SIN_RESPUESTA_DGII.md** üìñ GU√çA DETALLADA

**Prop√≥sito:** Gu√≠a completa sobre el c√≥digo 99

**Contenido:**

- Descripci√≥n detallada del c√≥digo 99
- Ejemplo de respuesta de TheFactoryHKA
- C√≥digo de observaci√≥n 7777
- Implementaci√≥n en backend y FileMaker
- Flujo t√≠pico de estados
- Recomendaciones de manejo
- Tiempos de respuesta de DGII

**Para qui√©n:** Desarrolladores, implementadores

**Enlace:** [CODIGO_99_SIN_RESPUESTA_DGII.md](./CODIGO_99_SIN_RESPUESTA_DGII.md)

---

### 3. **FAQ_CODIGO_99.md** ‚ùì PREGUNTAS FRECUENTES

**Prop√≥sito:** Respuestas r√°pidas a preguntas comunes

**Contenido:**

- 20 preguntas frecuentes con respuestas detalladas
- Cuadros comparativos
- Resumen r√°pido
- Casos de uso comunes

**Para qui√©n:** Usuarios finales, soporte t√©cnico, administradores

**Enlace:** [FAQ_CODIGO_99.md](./FAQ_CODIGO_99.md)

---

### 4. **FileMaker_Manejo_Codigo99.fmfn** üíª C√ìDIGO DE IMPLEMENTACI√ìN

**Prop√≥sito:** Script completo para FileMaker

**Contenido:**

- Script completo de manejo del c√≥digo 99
- Parseo de respuesta JSON
- L√≥gica de intervalos de consulta
- Mensajes al usuario
- Campos necesarios en la base de datos
- Script de consulta autom√°tica
- Notas de implementaci√≥n

**Para qui√©n:** Desarrolladores de FileMaker

**Ubicaci√≥n:** [scripts/FileMaker_Manejo_Codigo99.fmfn](../scripts/FileMaker_Manejo_Codigo99.fmfn)

---

## üóÇÔ∏è Documentaci√≥n Relacionada

### C√≥digos de Estado

- **ESTADOS_THEFACTORY.md** - Todos los estados de TheFactoryHKA
- **CODIGOS_ERROR_DGII_COMPLETOS.md** - C√≥digos completos de DGII
- **ERROR_613_DGII_ANALISIS.md** - An√°lisis del error 613

### Implementaci√≥n

- **controllers/comprobantes.js** - C√≥digo del backend (modificado)
- L√≠neas ~386 y ~500: Manejo del c√≥digo 99

---

## üéØ Rutas R√°pidas seg√∫n tu Necesidad

### "¬øQu√© es el c√≥digo 99?"

‚Üí Ir a: [FAQ_CODIGO_99.md - Pregunta 1](./FAQ_CODIGO_99.md#1-qu√©-significa-el-c√≥digo-99)

### "¬øPuedo entregar la factura?"

‚Üí Ir a: [FAQ_CODIGO_99.md - Pregunta 2](./FAQ_CODIGO_99.md#2-puedo-entregar-la-factura-al-cliente-con-c√≥digo-99)

### "¬øC√≥mo implementarlo en FileMaker?"

‚Üí Ir a: [FileMaker_Manejo_Codigo99.fmfn](../scripts/FileMaker_Manejo_Codigo99.fmfn)

### "¬øQu√© cambios se hicieron en el c√≥digo?"

‚Üí Ir a: [RESUMEN_CODIGO_99.md](./RESUMEN_CODIGO_99.md#-soluci√≥n-implementada)

### "¬øCu√°nto tiempo esperar?"

‚Üí Ir a: [FAQ_CODIGO_99.md - Pregunta 3](./FAQ_CODIGO_99.md#3-cu√°nto-tiempo-tarda-dgii-en-responder)

### "¬øCada cu√°nto consultar?"

‚Üí Ir a: [FAQ_CODIGO_99.md - Pregunta 6](./FAQ_CODIGO_99.md#6-cada-cu√°nto-debo-consultar-el-estatus)

### "¬øQu√© es el c√≥digo 7777?"

‚Üí Ir a: [FAQ_CODIGO_99.md - Pregunta 5](./FAQ_CODIGO_99.md#5-qu√©-es-el-c√≥digo-de-observaci√≥n-7777)

---

## üìã Checklist de Implementaci√≥n

### Backend (Node.js/Express)

- [x] C√≥digo 99 agregado en `normalizarEstadoFactura()` - L√≠nea ~386
- [x] C√≥digo 99 agregado en fallback - L√≠nea ~500
- [x] Documentaci√≥n actualizada
- [x] No hay errores de linting

### Documentaci√≥n

- [x] RESUMEN_CODIGO_99.md creado
- [x] CODIGO_99_SIN_RESPUESTA_DGII.md creado
- [x] FAQ_CODIGO_99.md creado
- [x] ESTADOS_THEFACTORY.md actualizado
- [x] CODIGOS_ERROR_DGII_COMPLETOS.md actualizado
- [x] INDICE_CODIGO_99.md creado (este archivo)

### Scripts de FileMaker

- [x] FileMaker_Manejo_Codigo99.fmfn creado
- [ ] Implementar en FileMaker (pendiente usuario)
- [ ] Crear campos en base de datos (pendiente usuario)
- [ ] Configurar consultas autom√°ticas (pendiente usuario)

---

## üîÑ Flujo de Lectura Recomendado

### Para Desarrolladores

```
1. RESUMEN_CODIGO_99.md
   ‚Üì
2. CODIGO_99_SIN_RESPUESTA_DGII.md
   ‚Üì
3. controllers/comprobantes.js (revisar cambios)
   ‚Üì
4. FileMaker_Manejo_Codigo99.fmfn
   ‚Üì
5. FAQ_CODIGO_99.md (referencia)
```

### Para Usuarios/Soporte

```
1. FAQ_CODIGO_99.md
   ‚Üì
2. CODIGO_99_SIN_RESPUESTA_DGII.md (si necesitan m√°s detalles)
```

### Para Administradores

```
1. RESUMEN_CODIGO_99.md
   ‚Üì
2. FAQ_CODIGO_99.md
   ‚Üì
3. CODIGO_99_SIN_RESPUESTA_DGII.md (implementaci√≥n)
```

---

## üìä Mapeo de C√≥digos de Estado

### C√≥digo 99 en el Contexto de Todos los Estados

| C√≥digo   | Mensaje                           | Estado Normalizado | Tipo           |
| -------- | --------------------------------- | ------------------ | -------------- |
| 0        | Documento procesado correctamente | APROBADA           | ‚úÖ √âxito       |
| 1        | Aceptado                          | APROBADA           | ‚úÖ √âxito       |
| 2        | En proceso de validaci√≥n          | EN_PROCESO         | ‚è≥ Proceso     |
| 10       | Pendiente de procesamiento        | EN_PROCESO         | ‚è≥ Proceso     |
| 15       | En validaci√≥n                     | EN_PROCESO         | ‚è≥ Proceso     |
| 95       | Pendiente por ser enviado a DGII  | EN_PROCESO         | ‚è≥ Proceso     |
| **99**   | **SIN RESPUESTA DGII**            | **EN_PROCESO**     | **‚è≥ Proceso** |
| 108      | NCF ya presentado                 | NCF_INVALIDO       | ‚ùå Error       |
| 109      | NCF vencido                       | NCF_VENCIDO        | ‚ùå Error       |
| 110      | RNC no autorizado                 | RNC_NO_AUTORIZADO  | ‚ùå Error       |
| 200-299  | Rechazado por DGII                | RECHAZADA          | ‚ùå Error       |
| 300-301  | Documento anulado                 | ANULADA            | üö´ Cancelado   |
| 613, 634 | Error de reglas de negocio        | RECHAZADA          | ‚ùå Error       |

---

## üé® Colores para UI/UX

### C√≥digo 99 - EN_PROCESO

**Color Primario:** `#FFC107` (Amarillo/√Åmbar)

- RGB: `255, 193, 7`
- Hex: `#FFC107`

**Uso:**

- Fondo de alertas/notificaciones
- Color de texto de estado
- Indicadores visuales

**Mensaje Visual:**

```
‚è≥ Esperando confirmaci√≥n de DGII
```

---

## üìû Contactos y Soporte

### Sistema de Facturaci√≥n LabContreras

- **Repositorio:** `labcontreras-backend`
- **Backend:** Node.js/Express
- **Base de datos:** MongoDB

### Soporte Externo

- **TheFactoryHKA:** soporte@thefactoryhka.com.do
- **DGII:** 809-689-3444
- **Portal DGII:** https://dgii.gov.do/

---

## üìà M√©tricas a Monitorear

### Despu√©s de Implementar

1. **Frecuencia de C√≥digo 99**

   - ¬øCu√°ntas facturas obtienen c√≥digo 99?
   - ¬øEs la mayor√≠a o casos aislados?

2. **Tiempo en C√≥digo 99**

   - Promedio de tiempo hasta resoluci√≥n
   - Tiempo m√≠nimo y m√°ximo observado

3. **Tasa de Resoluci√≥n**

   - ¬øCu√°ntos c√≥digo 99 terminan en APROBADA?
   - ¬øCu√°ntos terminan en error?

4. **Patrones de Horario**
   - ¬øHay horarios con m√°s c√≥digo 99?
   - ¬øFines de semana vs. d√≠as h√°biles?

---

## üîç Troubleshooting R√°pido

| S√≠ntoma                         | Causa Probable           | Soluci√≥n                              |
| ------------------------------- | ------------------------ | ------------------------------------- |
| C√≥digo 99 por m√°s de 24h        | Problema en DGII         | Contactar TheFactoryHKA               |
| C√≥digo 99 en todas las facturas | Problema de comunicaci√≥n | Verificar conectividad                |
| No se mapea a EN_PROCESO        | C√≥digo no actualizado    | Verificar controllers/comprobantes.js |
| Error en FileMaker              | Script no implementado   | Usar FileMaker_Manejo_Codigo99.fmfn   |

---

## üöÄ Pr√≥ximos Pasos Sugeridos

1. [ ] Implementar script en FileMaker
2. [ ] Crear campos en base de datos FileMaker
3. [ ] Configurar consultas autom√°ticas
4. [ ] Monitorear frecuencia de c√≥digo 99 por 1 semana
5. [ ] Ajustar intervalos de consulta seg√∫n m√©tricas
6. [ ] Crear alerta para c√≥digo 99 > 24 horas
7. [ ] Documentar casos especiales encontrados

---

## üìù Historial de Cambios

### Versi√≥n 1.0 - 17 de octubre de 2025

**Archivos Creados:**

- `docs/CODIGO_99_SIN_RESPUESTA_DGII.md`
- `docs/FAQ_CODIGO_99.md`
- `docs/RESUMEN_CODIGO_99.md`
- `docs/INDICE_CODIGO_99.md`
- `scripts/FileMaker_Manejo_Codigo99.fmfn`

**Archivos Modificados:**

- `controllers/comprobantes.js` (l√≠neas ~386 y ~500)
- `docs/ESTADOS_THEFACTORY.md`
- `docs/CODIGOS_ERROR_DGII_COMPLETOS.md`

**Estado:** ‚úÖ Implementado y documentado

---

## üìÑ Licencia y Uso

Esta documentaci√≥n es parte del sistema de facturaci√≥n electr√≥nica de **LabContreras** y est√° destinada para uso interno y de sus desarrolladores autorizados.

---

**√öltima actualizaci√≥n:** 17 de octubre de 2025  
**Versi√≥n:** 1.0  
**Mantenido por:** Sistema de Facturaci√≥n LabContreras
